<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.69.0" />


<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon-16x16.png">
<link rel="manifest" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/site.webmanifest">
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/safari-pinned-tab.svg" color="#8b81c3">
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#8b81c3">
<meta name="msapplication-config" content="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


<title>Clase 1: Introduccion al Analisis de Datos Funcionales - Analisis de datos funcionales</title>

<meta name="author" content="Juan Antonio Cuesta-Albetos" />
<meta name="description" content="En este cuaderno damos una breve introduccion al analisis de datos funcionales en R usando 2 librerias fda de Ramsey y Wickham y su adaptacionfda." />

<meta name="keywords" content="Functional data analysis, fda, fda.usc" />


<meta property="og:title" content="Clase 1: Introduccion al Analisis de Datos Funcionales" />
<meta property="og:description" content="En este cuaderno damos una breve introduccion al analisis de datos funcionales en R usando 2 librerias fda de Ramsey y Wickham y su adaptacionfda." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2020-04-24-clase-01/" />
<meta property="og:image" content="/img/og.png"/>
<meta property="article:published_time" content="2020-04-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-24T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/img/og.png"/>

<meta name="twitter:title" content="Clase 1: Introduccion al Analisis de Datos Funcionales"/>
<meta name="twitter:description" content="En este cuaderno damos una breve introduccion al analisis de datos funcionales en R usando 2 librerias fda de Ramsey y Wickham y su adaptacionfda."/>






<link rel="stylesheet" href="/css/main.min.css" />



<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.0/dist/jquery.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" integrity="sha256-h2tMEmhemR2IN4wbbdNjj9LaDIjzwk2hralQwfJmBOE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />









<body class="d-flex flex-column h-100">
    <header>
    
    <div class="container-lg clearfix">
        <div class="col-12 p-3">
            <a id="main-title" href="/">Analisis de datos funcionales</a>
            <span id="sub-title">Codigos y cuadernos para la clase</span>
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-md-9 col-12 float-left" id="content">
                
<article>
    <h4 id="post-title">
        <a href="/2020-04-24-clase-01/">Clase 1: Introduccion al Analisis de Datos Funcionales</a>
    </h4>
    <div id="post-meta">
        <span>
    <time datetime="2020-04-24 00:00:00 &#43;0000 UTC">2020-04-24</time> |
</span>
<span>
    <span>821 words</span> |
</span>
<span>
    
    
    <a href="//tags/functional-data-analysis/">Functional data analysis</a>
    
    <a href="//tags/fda/">fda</a>
    
    <a href="//tags/fda.usc/">fda.usc</a>
    
    
</span>
    </div>
    
    <div class="markdown-body" id="post-content">
        


<p>En este cuaderno damos una breve introduccion al analisis de datos funcionales en R usando 2 librerias <a href="https://cran.r-project.org/web/packages/fda/fda.pdf">fda</a> de <em>Ramsey y Wickham</em> y su adaptacion
<a href="https://cran.r-project.org/web/packages/fda.usc/fda.usc.pdf">fda.usc</a> de <em>Bande, de la Fuente, Galeano, Nieto-Reyes, y Garcia-Portugues</em>. Dichos paquetes contienen rutinas para el analisis exploratorio de datos funcionales como profundidades, deteccion de curvas atipicas, modelos de regresion, clasificacion supervisada y analisis funcional de varianzas.</p>
<p>Para instalar el paquete y sus dependencias basta con correr el siguiente codigo:</p>
<pre class="r"><code># Instalando el paquete
install.packages(&quot;fda.usc&quot;)
install.packages(&quot;ggplot2&quot;)
# librerias
library(fda.usc)
library(ggplot2)</code></pre>
<p>A continuacion analizaremos los datos de crecimiento de jovenes en Bekerley, entre los anios 1 u 18, almacenados en la lista <strong>growth</strong>, para mayor informacion digitar el comando <em>help(growth)</em>. Dado que los datos esta en formato lista, haremos una tranformacion de los datos para dejarlos en formato tabla, <em>data.frame</em> y tipo <em>tidy</em>.</p>
<p>Para graficar los datos usando los metodos estandar de R basta con correr el siguiente codigo</p>
<pre class="r"><code># Unir la data de los ninios y ninias
Datos=t(cbind(growth$hgtm,growth$hgtf))
# Diferenciar las observaciones por su genero
sexo=c(rep(&quot;boy&quot;,39),rep(&quot;girl&quot;,54))
# Extraer las edades
edad=growth$age
# otros valores adicionales
Mm=max(Datos);mm=min(Datos)
Personas=c(1:93)
# El grafico es:
plot(c(1,edad[31]),c(mm,Mm),
     col=&quot;white&quot;,
     xlab=&quot;edad&quot;,
     ylab=&quot;altura&quot;, 
     main=&quot;Curvas de crecimiento. 93 personas&quot;
     )
for (i in Personas) lines(edad,Datos[i,],pch=3,cex=.5)</code></pre>
<p><img src="/post/2020-04-24-Clase-01_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Ahora bien, para realizar una segmentacion por el sexo hacemos:</p>
<pre class="r"><code>color=rep(&quot;pink&quot;,93)                    # definimos el color rosado a las ninias 
color[sexo==&quot;boy&quot;]=rep(&quot;lightblue&quot;,39)  # definimos el color azul para los ninios

plot(c(1,edad[31]),c(mm,Mm),
     col=&quot;white&quot;,
     xlab=&quot;edad&quot;,
     ylab=&quot;altura&quot;, 
     main=&quot;Curvas de crecimiento \n 93 personas&quot;
     )
for (i in Personas) lines(edad,Datos[i,],pch=3,cex=.5,col=color[i])</code></pre>
<p><img src="/post/2020-04-24-Clase-01_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>En el ultimo grafico se observa que la curva de creciemiento de los ninios es ligeramente mayor en las edades entre los 15 y 18 anios, aunque en los primeros anios el creciment para ambos sexos es el mismo.</p>
<p>Ahora bien, recordemos que dicho grafico reconstruye las curvas de crecimiento usando los puntos muestreados en la evolucion del experimento, por lo que la data, sin realizar las interpolaciones lineales es poco informativo, y se muestra a continuacion:</p>
<pre class="r"><code>#Datos de crecimiento. Sin separar por sexos
plot(c(1,edad[31]),c(mm,Mm),
     col=&quot;white&quot;,
     xlab=&quot;edad&quot;,
     ylab=&quot;altura&quot;, 
     main=&quot;Curvas de crecimiento.\n 93 personas&quot;
     )
for (i in Personas) points(edad,Datos[i,],pch=16,cex=.75)</code></pre>
<p><img src="/post/2020-04-24-Clase-01_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="tecator" class="section level2">
<h2>Tecator</h2>
<p><strong>tecator</strong> es una data guia dentro de la librera <em>fda.suc</em> que sirve como guie y ejemplo para mostrar la funcionalidad del paquete como tal, tecator contiene los registros de agua, grasa y proteina en muestras de carne. Son 215 muestras, donde las primeras 129 observaciones se usaron como conjunto de entreanmiento.</p>
<pre class="r"><code># Tecator.
data(tecator)                  # Cargar la data tecator
absorp=tecator$absorp.fdata    # Extraer el conjunto absorp de tecator
class(absorp)                  # Revisar el tipo de objecto </code></pre>
<pre><code>## [1] &quot;fdata&quot;</code></pre>
<p>La clase <em>fdata</em> es el tipo de objetos utilizados por la libreria para almacenar datos de tipo funcional, este tipo de objetos tienen los metodos de plot sobrecargados, por lo tanto, graficar data funcional almacenada del tipo <em>“fdata”</em> basta simplemente realizar el siguiente comando:</p>
<pre class="r"><code>plot(absorp,col = &quot;black&quot;)</code></pre>
<p><img src="/post/2020-04-24-Clase-01_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="datos-de-consumo-de-luz-electrica" class="section level1">
<h1>Datos de consumo de luz electrica</h1>
<p>El siguiente ejemplo son los registros de consumo de energia electrica en Santander, la data fue almacenada en el documento de texto <em>data.txt</em> que se adjunta con el documento, para cargarlo basta con que dicho archivo se encuentre en la misma carpeta donde se corre este cuaderno. Para cargarlo al sistema utilizaremos la funcion a continacion:</p>
<pre class="r"><code>DatosLuz = read.csv(&quot;DatosLuz.txt&quot;,sep = &quot; &quot;)
d=dim(DatosLuz)
d</code></pre>
<pre><code>## [1] 103  96</code></pre>
<p>La funcion <em>dim()</em> almacena las dimensiones de una matriz o data.frame, donde el primer elemento son las filas, y el segundo las columnas, para el caso de los resgistros de luz, se poseen 103 datos, y a cada uno de ellos se realizaron 96 mediciones. Procedemos a estandarizar los datos para que estos den valores entre o y 1.</p>
<pre class="r"><code># Copia de los datos
DatosLuzN=DatosLuz
# Estandarizar
for (i in 1:d[1]){
  DatosLuzN[i,]=DatosLuz[i,]/(max(DatosLuz[i,])+.0001)
}</code></pre>
<p>Procedemos a graficar nuestros datos estandarizados</p>
<pre class="r"><code># El tiempo entre las mediciones de los datos
Tiempo=c(1:d[2])

plot(c(1,96),c(0,1),
     col=&quot;white&quot;,
     xlab=&quot; Tiempo &quot;, 
     ylab=&quot;consumo estandarizado &quot;, 
     main=&quot;Curvas de consumo de luz&quot;
     )
for (i in 1:103) lines(Tiempo,DatosLuzN[i,],col=i)</code></pre>
<p><img src="/post/2020-04-24-Clase-01_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>La data graficada es tanta, y cada uno de los registros de consumo tiene un comportamiento tan diferente del otro, que es muy dificil extraer patrones e informacion usando el grafico anterior, para eso, extraeremos un pequenio conjunto de ellos y los graficaremos una pequenia muestra de ellos</p>
<pre class="r"><code>set.seed(1921)      # Semilla aleatoria para que siempre genere la misma muestra
s=sample(1:103, 20) #  Muestra de las filas a extraer para analizar 
par(mfrow=c(2,2))   # El parametro para generar una malla grafica de 2x2 

# grafico 1
plot(c(1,96),c(0,1),col=&quot;white&quot;,xlab=&quot; Tiempo&quot;,ylab=&quot;consumo estandarizado&quot;, 
     main=&quot;Curvas de consumo de luz&quot;)
 for (i in 1:5) lines(Tiempo,DatosLuzN[s[i],],col=i)

# grafico 2
plot(c(1,96),c(0,1),col=&quot;white&quot;,xlab=&quot; Tiempo &quot;, ylab=&quot;consumo estandarizado &quot;, main=&quot;Curvas de consumo de luz&quot;)
 for (i in 6:10) lines(Tiempo,DatosLuzN[s[i],],col=i)

# grafico 3
plot(c(1,96),c(0,1),col=&quot;white&quot;,xlab=&quot; Tiempo &quot;, ylab=&quot;consumo estandarizado &quot;, main=&quot;Curvas de consumo de luz&quot;)
 for (i in 11:15)lines(Tiempo,DatosLuzN[s[i],],col=i)

# grafico 4
plot(c(1,96),c(0,1),col=&quot;white&quot;,xlab=&quot; Tiempo &quot;, ylab=&quot;consumo estandarizado &quot;, main=&quot;Curvas de consumo de luz&quot;)
 for (i in 16:20)lines(Tiempo,DatosLuzN[s[i],],col=i)</code></pre>
<p><img src="/post/2020-04-24-Clase-01_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow=c(1,1)) # Regresar a una sola malla
rm(list = ls())   # Limpiar el ordenador eliminando todas las  variables</code></pre>
</div>

    </div>
</article>

<div class="markdown-body" id="license">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License (CC BY-NC-SA 4.0)</a>.</p>
    </blockquote>
</div>




            </div>
            
            <div class="col-md-3 col-12 float-left" id="sidebar">
                
<div id="widget-toc">
    <h5>TOC</h5>
    
</div>

<div id="widget-pages">
    <h5>Pages</h5>
    <ul>
        
        
        <li>
            <a href="/">Home</a>
        </li>
        
        <li>
            <a href="/archives/">Archivos</a>
        </li>
        
        <li>
            <a href="/about/">About</a>
        </li>
        
    </ul>
</div>
<div id="widget-tags">
    <h5>Tags</h5>
    <div>
        
        <span>
            <a href="/tags/derivadas/">derivadas</a>
        </span>
        
        <span>
            <a href="/tags/fda/">fda</a>
        </span>
        
        <span>
            <a href="/tags/fda.usc/">fda.usc</a>
        </span>
        
        <span>
            <a href="/tags/functional-data-analysis/">Functional data analysis</a>
        </span>
        
        <span>
            <a href="/tags/growth/">growth</a>
        </span>
        
        <span>
            <a href="/tags/linear/">linear</a>
        </span>
        
        <span>
            <a href="/tags/movimiento-browniano/">Movimiento browniano</a>
        </span>
        
        <span>
            <a href="/tags/proceso-gaussiano/">Proceso Gaussiano</a>
        </span>
        
        <span>
            <a href="/tags/splines/">splines</a>
        </span>
        
        <span>
            <a href="/tags/tecator/">tecator</a>
        </span>
        
    </div>
</div>
<div id="widget-links">
    <h5>Links</h5>
    <ul>
        
        <li>
            <a href="https://github.com/asael697" target="_blank"><span>GitHub</span></a>
        </li>
        
        <li>
            <a href="https://twitter.com/Asael_am" target="_blank"><span>Twitter</span></a>
        </li>
        
        <li>
            <a href="https://www.jstatsoft.org/article/view/v051i04" target="_blank"><span>fda.usc</span></a>
        </li>
        
    </ul>
</div>

            </div>
            
            
            <div id="scroll-top">
                <i class="fas fa-chevron-up"></i>
            </div>
            
        </div>
    </main>

    <footer>
    <div class="container-lg text-center">
        <p>&copy; 2020 <a href="/">Juan Antonio Cuesta-Albetos, Asael Alonzo Matamoros</a> | Powered by <a href="https://github.com/amzrk2/hugo-theme-fuji/" target="_blank">Fuji</a> & <a href="https://gohugo.io/" target="_blank">Hugo</a> </p>
    </div>
</footer>
    




<script>
    $("#widget-toc a").click(function () {
        $("html, body").animate({
            scrollTop: $($(this).attr("href")).offset().top
        });
        return false;
    });
</script>



<script>
    $("#scroll-top").click(function () {
        $("html, body").animate({
            scrollTop: 0
        });
    });
</script>


</body>

</html>