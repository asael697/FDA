<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.69.0" />


<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon-16x16.png">
<link rel="manifest" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/site.webmanifest">
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/safari-pinned-tab.svg" color="#8b81c3">
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#8b81c3">
<meta name="msapplication-config" content="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


<title>Clase 03: Derivadas de datos - Analisis de datos funcionales</title>

<meta name="author" content="Juan Antonio Cuesta-Albetos" />
<meta name="description" content="Se presenta la aproximación de derivadas en curvas, usando interpoladores lineales y splines.
Los datos a utilizar es tecator, que contiene muestras de grasa, agua y proteina en carnes. Los datos están disponible en el paquete fda.usc, para acceder a su documentación basta usar:
# se cargan los datosdata(&quot;tecator&quot;)#Llamado del help?tecatorCalculo de las derivadas de los datos del TecatorPrimero separamos el contenido de grasa y el resto de la variables, de tecator, para simplificación de código.
fat = tecator$y$Fatdatos = tecator$absorp.fdataondas=datos$argvalsPor defecto la librería fda.usc usa por defecto approximaciones lineales en métodos gráficos y resúmenes, en este trabajo se usaran splines de orden 9 y de orden 41." />

<meta name="keywords" content="derivadas, splines, tecator" />


<meta property="og:title" content="Clase 03: Derivadas de datos" />
<meta property="og:description" content="Se presenta la aproximación de derivadas en curvas, usando interpoladores lineales y splines.
Los datos a utilizar es tecator, que contiene muestras de grasa, agua y proteina en carnes. Los datos están disponible en el paquete fda.usc, para acceder a su documentación basta usar:
# se cargan los datosdata(&quot;tecator&quot;)#Llamado del help?tecatorCalculo de las derivadas de los datos del TecatorPrimero separamos el contenido de grasa y el resto de la variables, de tecator, para simplificación de código.
fat = tecator$y$Fatdatos = tecator$absorp.fdataondas=datos$argvalsPor defecto la librería fda.usc usa por defecto approximaciones lineales en métodos gráficos y resúmenes, en este trabajo se usaran splines de orden 9 y de orden 41." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2020-04-22-clase-03/" />
<meta property="og:image" content="/img/og.png"/>
<meta property="article:published_time" content="2020-04-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-22T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/img/og.png"/>

<meta name="twitter:title" content="Clase 03: Derivadas de datos"/>
<meta name="twitter:description" content="Se presenta la aproximación de derivadas en curvas, usando interpoladores lineales y splines.
Los datos a utilizar es tecator, que contiene muestras de grasa, agua y proteina en carnes. Los datos están disponible en el paquete fda.usc, para acceder a su documentación basta usar:
# se cargan los datosdata(&quot;tecator&quot;)#Llamado del help?tecatorCalculo de las derivadas de los datos del TecatorPrimero separamos el contenido de grasa y el resto de la variables, de tecator, para simplificación de código.
fat = tecator$y$Fatdatos = tecator$absorp.fdataondas=datos$argvalsPor defecto la librería fda.usc usa por defecto approximaciones lineales en métodos gráficos y resúmenes, en este trabajo se usaran splines de orden 9 y de orden 41."/>






<link rel="stylesheet" href="/css/main.min.css" />



<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.0/dist/jquery.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" integrity="sha256-h2tMEmhemR2IN4wbbdNjj9LaDIjzwk2hralQwfJmBOE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />









<body class="d-flex flex-column h-100">
    <header>
    
    <div class="container-lg clearfix">
        <div class="col-12 p-3">
            <a id="main-title" href="/">Analisis de datos funcionales</a>
            <span id="sub-title">Codigos y cuadernos para la clase</span>
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-md-9 col-12 float-left" id="content">
                
<article>
    <h4 id="post-title">
        <a href="/2020-04-22-clase-03/">Clase 03: Derivadas de datos</a>
    </h4>
    <div id="post-meta">
        <span>
    <time datetime="2020-04-22 00:00:00 &#43;0000 UTC">2020-04-22</time> |
</span>
<span>
    <span>673 words</span> |
</span>
<span>
    
    
    <a href="//tags/derivadas/">derivadas</a>
    
    <a href="//tags/splines/">splines</a>
    
    <a href="//tags/tecator/">tecator</a>
    
    
</span>
    </div>
    
    <div class="markdown-body" id="post-content">
        


<p>Se presenta la aproximación de derivadas en curvas, usando interpoladores lineales y splines.</p>
<p>Los datos a utilizar es <strong>tecator</strong>, que contiene muestras de grasa, agua y proteina en carnes. Los datos están disponible en el paquete <strong>fda.usc</strong>, para acceder a su documentación basta usar:</p>
<pre class="r"><code># se cargan los datos
data(&quot;tecator&quot;)

#Llamado del help
?tecator</code></pre>
<div id="calculo-de-las-derivadas-de-los-datos-del-tecator" class="section level1">
<h1>Calculo de las derivadas de los datos del Tecator</h1>
<p>Primero separamos el contenido de grasa y el resto de la variables, de tecator, para simplificación de código.</p>
<pre class="r"><code>fat   = tecator$y$Fat
datos = tecator$absorp.fdata
ondas=datos$argvals</code></pre>
<p>Por defecto la librería <em>fda.usc</em> usa por defecto approximaciones lineales en métodos gráficos y resúmenes, en este trabajo se usaran splines de orden 9 y de orden 41.</p>
<pre class="r"><code># Aproximaciones por Splines
x0_9  = fdata.deriv(datos,nderiv=0,nbasis=9)  # orden 9
x0_41 = fdata.deriv(datos,nderiv=0,nbasis=41) # orden 41

#gráficos de las curvas 
par(mfrow = c(1,3))
 plot(x0_41,col=&quot;blue&quot;,type=&quot;l&quot;,ylab =&quot;absorción&quot;,lty=1,main=&quot;Aproxim. orden 41&quot;)
 plot(x0_9 ,col=&quot;red&quot; ,type=&quot;l&quot;,ylab =&quot;absorción&quot;,lty=1,main=&quot;Aproxim. orden 9&quot;)
 plot(datos,col=&quot;black&quot; ,type=&quot;l&quot;,ylab =&quot;absorción&quot;,lty=1,main=&quot;Aproxim. lineal&quot;)</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1,1))</code></pre>
<p>Hacemos lo mismo para el cálculo de las segundas derivadas</p>
<pre class="r"><code># Aproximaciones por Splines
x2_9  = fdata.deriv(datos,nderiv=2,nbasis=9)  # orden 9
x2_41 = fdata.deriv(datos,nderiv=2,nbasis=41) # orden 41

#gráficos de las segundas derivadas
layout(matrix(c(1,2,3,3), 2, 2, byrow = TRUE))
 plot(x2_9, col=&quot;blue&quot;,type=&quot;l&quot;,ylab =&quot;2da derivada&quot;,lty=1,main=&quot;Aproxim. orden 9&quot;)
 plot(x2_41,col=&quot;red&quot; ,type=&quot;l&quot;,ylab =&quot;2da derivada&quot;,lty=1,main=&quot;Aproxim. orden 41&quot;)
 plot(x2_41,col=&quot;blue&quot;,type=&quot;l&quot;,lty=1,main=&quot;Aproximaciones segunda derivada&quot;)
  lines(x2_9,col=&quot;red&quot;,type=&quot;l&quot;,lty=1)</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Hacemos cortes en los contenidos de grasa de 25 y 15 unidades y preparamos las curvas, las bajas en grasa serán verdes, las altas serén rojas y amarillas las intermedias. La siguiente función nos permite graficar las curvas separadas por su contenido en grasas, note que, por defecto se hacen los cortes en 25 y 15.</p>
<pre class="r"><code># Grafico de curvas separadas por su contenido de grasa

# parámetro x: las curvas utilizadas
# parámetro corte: los cortes en los contenidos de grasa
# parámetro title: el titulo de nuestro gráfico
# parámetro curvas: un vector con indices para resaltar curvas
#
plot_curvas =function(x,corte = c(25,15),title,curvas = NULL){
  y = ifelse(fat &lt; corte[1],&quot;yellow&quot;,&quot;red&quot;) 
  y[fat &lt; corte[2] ] = rep(length(y[fat &lt; corte[2]]),x = &quot;green&quot;)
  y = factor(y)
  
  plot(x, col = as.character(y),type =&quot;l&quot;,lty = 1,main = title)
  legend(&quot;topleft&quot;,col = levels(y),lwd = 1,cex = 0.75,
         legend = c(paste(&quot;fat &gt;&quot;,corte[1],&quot;%&quot;),
                    paste(&quot;fat&quot;,&quot;intermediate &quot;),
                    paste(&quot;fat &lt;&quot;,corte[2],&quot;%&quot;)),
  )
  if(!is.null(curvas))
    for (i in 1:length(curvas)){
      lines(x$argvals,x$data[curvas[i],],lwd=3)
    }
}</code></pre>
<p>Las curvas originales se puede observar en el gráfico siguiente, parte superior izquierda, y sugiere que las curvas se segmentan naturalmente por su contenido de grasa, se desea conocer el contendio de grasa estimado de las curvas 99, 76 y 205. En la parte superior izquierda, se muestran las 3 curvas usando interpolación lineal. En los gráficos inferiores se muestran las 3 mismas curvas con las aproximaciones por splines.</p>
<pre class="r"><code>elijo.curvas = c(99,76,205)

layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE))
 plot_curvas(datos,title = &quot;Spectometric curves \n Linear interpolation&quot;)
 plot_curvas(x = datos,curvas = elijo.curvas,
            title = &quot;Spectometric curves. \n Linear interpolation&quot;)
  plot_curvas(x = x0_9,curvas = elijo.curvas,
            title = &quot;Spectometric curves.\n Aproxim. orden 09&quot;)
 plot_curvas(x = x0_41,curvas = elijo.curvas,
            title = &quot;Spectometric curves.\n Aproxim. orden 41&quot;)</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<p>Anque la figura anterior sugiere que las curvas inferiores tienen concentración mayor al 25% (<em>color verde</em>), en el siguiente gráfico se muestra que la curva negra intermedia tiene 9.6% de concentración (<em>es amarilla</em>) y la curva inferior tiene una concentración de 18.1% (<em>roja</em>).</p>
<pre class="r"><code>plot_curvas(x = datos,curvas = elijo.curvas,
            title = &quot;Spectometric curves. \n Linear interpolation&quot;)
text(datos$argvals[90],datos$data[elijo.curvas[1],90]+.15,paste(&quot;fat=&quot;,fat[elijo.curvas[1]]),cex=1,col=&quot;blue&quot;)
text(datos$argvals[90],datos$data[elijo.curvas[2],90]+.1,paste(&quot;fat=&quot;,fat[elijo.curvas[2]]),cex=1,col=&quot;blue&quot;)
text(datos$argvals[80],datos$data[elijo.curvas[3],80]-.1,paste(&quot;fat=&quot;,fat[elijo.curvas[3]]),cex=1,col=&quot;blue&quot;)</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>En la zona donde se clasifican por las segundas derivadas, las curvas iniciales son casi planas</p>
<pre class="r"><code>plot_curvas(x = datos[,ondas&lt;940 &amp; ondas&gt;920],
            title = &quot;Spectometric curves&quot;)</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Hacemos lo mismo con tres curvas elegidas al azar</p>
<pre class="r"><code># Muestra de 3 curvas
I = sample(1:215,3)

plot(datos[I],type = &quot;l&quot;,col = &quot;black&quot;,lty = 1,lwd = 4)
 lines(x0_9[I], col =   &quot;red&quot;,lty = 1)
 lines(x0_41[I],col = &quot;green&quot;,lty = 1)
  legend(&quot;topleft&quot;,col = c(1,2,3),lwd = 3,cex = 1,
         legend = c(&quot;Interpolacion lineal&quot;,&quot;Aproximacion orden 9&quot;,&quot;Aproximacion orden 41&quot;))</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Dibujamos juntas las segundas derivadas de las curvas.</p>
<pre class="r"><code>par(mfrow=c(2,2))
 plot_curvas(x = x2_9,title =&quot;2da derivada.\n Aproxim. orden 9&quot;)
 plot_curvas(x = x2_9,curvas = elijo.curvas,
             title =&quot;2da derivada. \n Aproxim. orden 9&quot;)
 plot_curvas(x = x2_41,title =&quot;2da derivada.\n Aproxim. orden 9&quot;)
 plot_curvas(x = x2_41,curvas = elijo.curvas,
             title =&quot;2da derivada. \n Aproxim. orden 9&quot;)</code></pre>
<p><img src="/post/2020-04-22-Clase-03_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<pre class="r"><code>par(mfrow=c(1,1))</code></pre>
</div>

    </div>
</article>

<div class="markdown-body" id="license">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License (CC BY-NC-SA 4.0)</a>.</p>
    </blockquote>
</div>




            </div>
            
            <div class="col-md-3 col-12 float-left" id="sidebar">
                
<div id="widget-toc">
    <h5>TOC</h5>
    
</div>

<div id="widget-pages">
    <h5>Pages</h5>
    <ul>
        
        
        <li>
            <a href="/">Home</a>
        </li>
        
        <li>
            <a href="/archives/">Archivos</a>
        </li>
        
        <li>
            <a href="/about/">About</a>
        </li>
        
    </ul>
</div>
<div id="widget-tags">
    <h5>Tags</h5>
    <div>
        
        <span>
            <a href="/tags/derivadas/">derivadas</a>
        </span>
        
        <span>
            <a href="/tags/fda/">fda</a>
        </span>
        
        <span>
            <a href="/tags/fda.usc/">fda.usc</a>
        </span>
        
        <span>
            <a href="/tags/functional-data-analysis/">Functional data analysis</a>
        </span>
        
        <span>
            <a href="/tags/growth/">growth</a>
        </span>
        
        <span>
            <a href="/tags/linear/">linear</a>
        </span>
        
        <span>
            <a href="/tags/movimiento-browniano/">Movimiento browniano</a>
        </span>
        
        <span>
            <a href="/tags/proceso-gaussiano/">Proceso Gaussiano</a>
        </span>
        
        <span>
            <a href="/tags/splines/">splines</a>
        </span>
        
        <span>
            <a href="/tags/tecator/">tecator</a>
        </span>
        
    </div>
</div>
<div id="widget-links">
    <h5>Links</h5>
    <ul>
        
        <li>
            <a href="https://github.com/asael697" target="_blank"><span>GitHub</span></a>
        </li>
        
        <li>
            <a href="https://twitter.com/Asael_am" target="_blank"><span>Twitter</span></a>
        </li>
        
        <li>
            <a href="https://www.jstatsoft.org/article/view/v051i04" target="_blank"><span>fda.usc</span></a>
        </li>
        
    </ul>
</div>

            </div>
            
            
            <div id="scroll-top">
                <i class="fas fa-chevron-up"></i>
            </div>
            
        </div>
    </main>

    <footer>
    <div class="container-lg text-center">
        <p>&copy; 2020 <a href="/">Juan Antonio Cuesta-Albetos, Asael Alonzo Matamoros</a> | Powered by <a href="https://github.com/amzrk2/hugo-theme-fuji/" target="_blank">Fuji</a> & <a href="https://gohugo.io/" target="_blank">Hugo</a> </p>
    </div>
</footer>
    




<script>
    $("#widget-toc a").click(function () {
        $("html, body").animate({
            scrollTop: $($(this).attr("href")).offset().top
        });
        return false;
    });
</script>



<script>
    $("#scroll-top").click(function () {
        $("html, body").animate({
            scrollTop: 0
        });
    });
</script>


</body>

</html>